# PostgreSQL configuration for Poducer
#
# Make sure pg gem is in your Gemfile:
#   gem "pg"
#
default: &default
  adapter: postgresql
  encoding: unicode
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %>

development:
  <<: *default
  database: poducer_development

test:
  <<: *default
  database: poducer_test

# === PRODUCTION DATABASE CONFIGURATION ===
#
# When you're ready to deploy to production, you have two options:
#
# Option A: Set DATABASE_URL environment variable (simplest, recommended for most hosts)
#   DATABASE_URL=postgres://username:password@hostname:5432/poducer_production
#   Most platforms (Render, Railway, Heroku, Fly.io) set this automatically
#   when you provision a PostgreSQL add-on.
#
# Option B: Set individual environment variables
#   DATABASE_HOST=your-db-host.example.com  (e.g. db.render.com, your-rds-instance.amazonaws.com)
#   DATABASE_USER=poducer
#   DATABASE_PASSWORD=your-secure-password
#   DATABASE_PORT=5432  (optional, defaults to 5432)
#
# For the Solid Cache/Queue/Cable databases, you can either:
#   1. Use separate databases (as configured below) — best for high-traffic apps
#   2. Consolidate into the primary database — simpler to manage, fine for most apps.
#      To consolidate, just remove the cache/queue/cable sections and run all
#      migrations against the primary database.
#
production:
  primary: &production_default
    <<: *default
    database: poducer_production
    username: <%= ENV["DATABASE_USER"] %>
    password: <%= ENV["DATABASE_PASSWORD"] %>
    host: <%= ENV["DATABASE_HOST"] %>
    port: <%= ENV.fetch("DATABASE_PORT", 5432) %>
  cache:
    <<: *production_default
    database: poducer_production_cache
    migrations_paths: db/cache_migrate
  queue:
    <<: *production_default
    database: poducer_production_queue
    migrations_paths: db/queue_migrate
  cable:
    <<: *production_default
    database: poducer_production_cable
    migrations_paths: db/cable_migrate
